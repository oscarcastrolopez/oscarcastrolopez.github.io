theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"))
##Line plot of new_cases with date breaks by month
plot.trend.new_cases.month <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = graphsubtitle,
caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
##Line plot of new_cases with date breaks by short month and days
plot.trend.new_cases.monthday <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = graphsubtitle,
caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
top5.total_cases <- c(head(as.character(top20.total_cases$location),5), "Mexico")
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
plot.trend.new_cases.month(startdate, enddate, top5.total_cases, "Tendencia de contagios de Covid-19", sublabel.tmp)
##Line plot of new_cases with date breaks by month
plot.trend.new_cases.month <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = graphsubtitle,
caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
##Line plot of new_cases with date breaks by short month and days
plot.trend.new_cases.monthday <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
top5.total_cases <- c(head(as.character(top20.total_cases$location),5), "Mexico")
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
plot.trend.new_cases.month(startdate, enddate, top5.total_cases, "Tendencia de contagios de Covid-19", sublabel.tmp)
##Line plot of new_cases with date breaks by month
plot.trend.new_cases.month <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
##Line plot of new_cases with date breaks by short month and days
plot.trend.new_cases.monthday <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
top5.total_cases <- c(head(as.character(top20.total_cases$location),5), "Mexico")
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
plot.trend.new_cases.month(startdate, enddate, top5.total_cases, "Tendencia de contagios de Covid-19", sublabel.tmp)
##Line plot of new_deaths with date breaks by month
plot.trend.new_deaths.month <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_deaths, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Nuevos muertes atribuibles a COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
##Line plot of new_deaths with date breaks by short month and day
plot.trend.new_deaths.monthdays <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=new_deaths, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Nuevos casos de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
top5.total_cases <- c(head(as.character(top20.total_cases$location),5), "Mexico")
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
title.tmp <- "Tendencia de nuevas muertes por Covid-19"
plot.trend.new_deaths.month(startdate, enddate, top5.total_cases, title.tmp, sublabel.tmp)
##Line plot of new_total_cases with date breaks by month
plot.trend.total_cases.month <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=total_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Casos acumulados de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
##Line plot of new_deaths with date breaks by short month and day
plot.trend.total_cases.monthdays <- function(startdate, enddate, countries, graphtitle, graphsubtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=total_cases, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = graphsubtitle)+
labs(caption = plotscaption)+
ylab("Casos acumulados de COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
title.tmp <- "Contagios acumulados de Covid-19"
plot.trend.total_cases.month(startdate, enddate, top5.total_cases, title.tmp, sublabel.tmp)
# Generate total_deaths line plot with month breaks
plot.trend.total_deaths.month <- function(startdate, enddate, countries, graphtitle, subgraphtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=total_deaths, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "month", date_labels = "%B")+
ggtitle(graphtitle,
subtitle = subgraphtitle)+
labs(caption = plotscaption)+
ylab("Muertes totales por COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
# Generate total_deaths line plot with month and day breaks
plot.trend.total_deaths.monthdays <- function(startdate, enddate, countries, graphtitle, subgraphtitle){
tmp.df <- covid.df[covid.df$location %in% countries,]
tmp.df <- tmp.df[tmp.df$date >= startdate,]
tmp.df <- tmp.df[tmp.df$date <= enddate,]
ggplot(data=tmp.df , aes(x=date, y=total_deaths, group=location, colour=location)) +
geom_line(size=1) +
scale_color_discrete(name = "Países")+
scale_x_date(date_breaks = "day", date_labels = "%b %d")+
ggtitle(graphtitle,
subtitle = subgraphtitle)+
labs(caption = plotscaption)+
ylab("Muertes totales por COVID-19")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
}
top5.total_deaths <-  head(as.character(top20.total_deaths$location),5)
sublabel.tmp <- paste("Rango:", format(startdate, "%d/%m/%Y"),"-", format(enddate, "%d/%m/%Y"))
title.tmp <- "Muertes acumuladas por Covid-19"
plot.trend.total_deaths.month(startdate, enddate, top5.total_deaths, title.tmp, sublabel.tmp)
covid.mexico <- covid.df[covid.df$location=='Mexico',]
covid.mexico <- covid.mexico[covid.mexico$date > "2020-04-01",]
covid.mexico.new <- covid.mexico[,c("date", "new_cases", "new_deaths")]
covid.mexico.new.lf <-melt(covid.mexico.new, id.vars = c("date"))
ggplot(data=covid.mexico.new.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
ggtitle("Curvas de contagios y muertes diarias por COVID-19 en México",
caption = plotscaption)+
labs(caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
covid.mexico <- covid.df[covid.df$location=='Mexico',]
covid.mexico <- covid.mexico[covid.mexico$date > "2020-04-01",]
covid.mexico.new <- covid.mexico[,c("date", "new_cases", "new_deaths")]
covid.mexico.new.lf <-melt(covid.mexico.new, id.vars = c("date"))
ggplot(data=covid.mexico.new.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
ggtitle("Curvas de contagios y muertes diarias por COVID-19 en México")+
labs(caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
covid.mexico.new.lastmonth <- covid.mexico.new[covid.mexico.new$date >= enddate-30, ]
covid.mexico.new.lastmonth.lf <- melt(covid.mexico.new.lastmonth, id.vars = c("date"))
ggplot(data=covid.mexico.new.lastmonth.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
ggtitle("Curvas de contagios y muertes diarias por COVID-19 en México - Último mes")+
labs(caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
covid.mexico.total <- covid.mexico[,c("date", "total_cases", "total_deaths")]
covid.mexico.total.lf <-melt(covid.mexico.total, id.vars = c("date"))
ggplot(data=covid.mexico.total.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
scale_y_continuous(breaks=c(50000, 100000, 200000, 300000, 400000, 500000, 750000),
label=c("50k","100k", "200k", "300k", "400k", "500k", "750k"))+
ggtitle("Curvas de contagios y muertes acumulados por COVID-19 en México")+
labs(caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
covid.mexico.total.lasttmonth <- covid.mexico.total[covid.mexico.total$date >= enddate-30, ]
covid.mexico.total.lasttmonth.lf <- melt(covid.mexico.total.lasttmonth, id.vars = c("date"))
ggplot(data=covid.mexico.total.lasttmonth.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
scale_y_continuous(breaks=c(50000, 100000, 200000, 300000, 400000, 500000, 750000),
label=c("50k","100k", "200k", "300k", "400k", "500k", "750k"))+
ggtitle("Curvas de contagios y muertes acumulados por COVID-19 en México - Último mes",
caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
ggplot(data=covid.mexico.total.lasttmonth.lf , aes(x=date, y=value, group=variable, colour=variable)) +
geom_line(size=1) +
scale_color_discrete(name = "Indicador", labels=c("Nuevos Contagios", "Nuevas Muertes"))+
scale_x_date(date_breaks = "week", date_labels = "%b %d")+
scale_y_continuous(breaks=c(50000, 100000, 200000, 300000, 400000, 500000, 750000),
label=c("50k","100k", "200k", "300k", "400k", "500k", "750k"))+
ggtitle("Curvas de contagios y muertes acumulados por COVID-19 en México - Último mes")+
labs(caption = plotscaption)+
ylab("")+
xlab("Fecha")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"),
legend.position = "bottom",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
legend.key.width = unit(1.5,"cm"))+
guides(colour = guide_legend(override.aes = list(size=2)))
covid.mexico <- covid.df[covid.df$location=='Mexico',]
week.agg <- covid.mexico %>%
group_by(week = week(date)) %>%
summarise(mean_new_cases = mean(new_cases),
n = n(),
loCI_new_cases = ci(new_cases)[2],
hiCI_new_cases = ci(new_cases)[3],
mean_new_deaths = mean(new_deaths),
loCI_new_deaths = ci(new_deaths)[2],
hiCI_new_deaths = ci(new_deaths)[3],
total_new_cases = sum(new_cases),
total_new_deaths = sum(new_deaths))
# Weeks with zero mean new cases are deleted
week.agg <- week.agg[which(week.agg$mean_new_cases > 0),]
# Finding the date of the first week to be ploted
firstweek <- min(week.agg$week)
rowindex <- match(firstweek, week(covid.mexico[,"date"]))
firstweek.date <- format(covid.mexico[rowindex, ]$date, "%d/%m/%Y")
rm(firstweek, rowindex)
# Finding the date of the last week to be ploted
lastweek <- max(week.agg$week)
rowindex <- match(lastweek, week(covid.mexico[,"date"]))
lastweek.date <- format(covid.mexico[rowindex, ]$date, "%d/%m/%Y")
rm(lastweek, rowindex)
sublabel <- paste("Rango:", firstweek.date, "-", lastweek.date)
ggplot(data=week.agg, aes(x=as.character(week),y=mean_new_cases))+
geom_bar(stat = 'identity', aes(fill = mean_new_cases)) +
geom_errorbar(aes(ymin=loCI_new_cases, ymax=hiCI_new_cases), width=.2,
position=position_dodge(.9)) +
xlab("Semana")+
ylab("Promedio semanal de casos ± IC 95%")+
labs(title="Promedio semanal de casos de COVID-19 en México",
subtitle = sublabel,
caption = plotscaption)+
scale_fill_gradient(name="Casos", low = "green", high = "red")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"))
ggplot(data=week.agg, aes(x=as.character(week),y=mean_new_deaths))+
geom_bar(stat = 'identity', aes(fill = mean_new_deaths)) +
geom_errorbar(aes(ymin=loCI_new_deaths, ymax=hiCI_new_deaths), width=.2,
position=position_dodge(.9)) +
xlab("Semana")+
ylab("Promedio semanal de muertes ± IC 95%")+
labs(title="Promedio semanal de muertes por COVID-19 en México",
subtitle = sublabel,
caption = plotscaption)+
scale_fill_gradient(name="Muertes", low = "green", high = "red")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"))
ggplot(data=week.agg, aes(x=as.character(week),y=total_new_cases))+
geom_bar(stat = 'identity', aes(fill = total_new_cases)) +
xlab("Semana")+
ylab("Casos totales por semana")+
labs(title="Casos totales de COVID-19 por semana en México",
subtitle = sublabel,
caption = plotscaption)+
scale_fill_gradient(name="Casos totales", low = "green", high = "red")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"))
ggplot(data=week.agg, aes(x=as.character(week),y=total_new_deaths))+
geom_bar(stat = 'identity', aes(fill = total_new_deaths)) +
xlab("Semana")+
ylab("Muertes totales por semana")+
labs(title="Muertes totales por COVID-19 por semana en México",
subtitle=sublabel,
caption = plotscaption)+
scale_fill_gradient(name="Muertes totales", low = "green", high = "red")+
theme_bw()+
theme(title = element_text(size=14, face="bold", colour = "black"),
axis.text.y = element_text(size=11, face="bold", colour = "black"),
axis.text.x = element_text(size=11, face="bold", colour = "black"))
